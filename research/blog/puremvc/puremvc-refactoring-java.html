<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Untitled</title>
    <meta name="author" content="Andy Bulka">

    <!-- <link rel="stylesheet" href="css/styles.css?v=1.0"> -->

</head>

<body>
    <!-- <script src="js/scripts.js"></script> -->

    <h1>Refactoring to PureMVC - Java version</h1>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Here is a Java version of the tutorial I originally wrote in wxPython. It leaves out most of the commentary and concentrates on the code, so please read the <a title="Refactoring to PureMVC" href="http://www.andypatterns.com/index.php?cID=84">original tutorial</a> for more detail about the meaning of the refactoring steps. </span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">I have used the same class names and the logic is identical (except for the parameters to the notification message DATA_SUBMITTED, which I have swapped around due to the fact that in the Java PureMVC framework the getBody() parameter is of type object whereas in dynamic Python the type of this paramter is more flexible – more explanation is found below).</span></p>
    <p style="margin-top: 0.42cm; page-break-after: avoid;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Step 1. Create a Basic Java GUI application form</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;"><span style="font-size: small;">Create a Java GUI application. Either hand code it or e.g. use Netbeans to kick start you. Then drop a </span></span></p>
    <p style="margin-top: 0.42cm;"><span style="font-family: Courier New,monospace;"><span style="font-size: x-small;">javax.swing.JTextField jTextField1</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">to the form. Don't bother adding any behaviour yet, lets get cracking with the refactoring.</span></p>
    <p style="margin-top: 0.42cm; page-break-after: avoid;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Step 2. Import PureMVC and add a mediator</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Here is the mediator.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * MyFormMediator.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.mediator.Mediator;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.INotification;<br /><span style="color: #0000e6;">import</span> javapuremvcminimal01.JavaPureMVCMinimal01Form;<br /><br /><span style="color: #0000e6;">import</span> java.awt.event.ActionEvent;<br /><span style="color: #0000e6;">import</span> java.awt.event.ActionListener;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>MyFormMediator</strong> <span style="color: #0000e6;">extends</span> Mediator <span style="color: #0000e6;">implements</span> ActionListener {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String NAME = <span style="color: #ce7b00;">"MyFormMediator"</span>;<br /><br />    <span style="color: #0000e6;">public</span> MyFormMediator(JavaPureMVCMinimal01Form viewComponent)<br />    {<br />        <span style="color: #0000e6;">super</span>(NAME, <span style="color: #0000e6;">null</span>);<br /><br />        setViewComponent(viewComponent);<br />        viewComponent.inputFieldTxt.addActionListener(<span style="color: #0000e6;">this</span>);<br />    }<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> actionPerformed(ActionEvent evt) {<br />        JavaPureMVCMinimal01Form form = (JavaPureMVCMinimal01Form) viewComponent;<br /><br />        form.inputFieldTxt.setText(form.inputFieldTxt.getText().toUpperCase());<br />    }<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Here is the application startup code, which was generated automatically by Netbeans 6.5 and the startup method was modified to create the PureMVC facade and mediator.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * JavaPureMVCMinimal01App.java</span><br /><span style="color: #969696;"> */</span><br /><br /><span style="color: #0000e6;">package</span> javapuremvcminimal01;<br /><br /><span style="color: #0000e6;">import</span> org.jdesktop.application.Application;<br /><span style="color: #0000e6;">import</span> org.jdesktop.application.SingleFrameApplication;<br /><br /><strong><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.facade.Facade;</strong><br /><strong><span style="color: #0000e6;">import</span> org.andy.MyFormMediator;</strong><br /><br /><span style="color: #969696;">/**</span><br /><span style="color: #969696;"> * The</span> <span style="color: #969696;">main</span> <span style="color: #969696;">class</span> <span style="color: #969696;">of</span> <span style="color: #969696;">the</span> <span style="color: #969696;">application.</span><br /> <span style="color: #969696;">* Based on a Netbeans 6.5 template.</span><br /> <span style="color: #969696;">*/</span><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> JavaPureMVCMinimal01App <span style="color: #0000e6;">extends</span> SingleFrameApplication {<br />    <span style="color: #0000e6;">public</span> JavaPureMVCMinimal01Form myForm;<br /><br />    <span style="color: #969696;">/**</span><br /><span style="color: #969696;"> * At</span> <span style="color: #969696;">startup</span> <span style="color: #969696;">create</span> <span style="color: #969696;">and</span> <span style="color: #969696;">show</span> <span style="color: #969696;">the</span> <span style="color: #969696;">main</span> <span style="color: #969696;">frame</span> <span style="color: #969696;">of</span> <span style="color: #969696;">the</span> <span style="color: #969696;">application.</span><br />     <span style="color: #969696;">*/</span><br />    @Override <span style="color: #0000e6;">protected</span> <span style="color: #0000e6;">void</span> startup() {<br />        myForm = <span style="color: #0000e6;">new</span> JavaPureMVCMinimal01Form(<span style="color: #0000e6;">this</span>);<br />        <strong>Facade mvcfacade = Facade.getInstance();</strong><br />        <strong>mvcfacade.registerMediator(</strong><span style="color: #0000e6;"><strong>new</strong></span> <strong>MyFormMediator(myForm));</strong><br />        show(myForm);<br />    }<br />    …<br />    …<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Since we need access to the textField in the swing form generated by netbeans, we declare a public variable for ourselves. Netbeans seems to make all the gui elements private – so we are fighting that.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * JavaPureMVCMinimal01Form.java</span><br /><span style="color: #969696;"> * (by default Netbeans names this JavaPureMVCMinimal01View but I renamed it).</span><br /><span style="color: #969696;"> */</span><br /><br /><span style="color: #0000e6;">package</span> javapuremvcminimal01;<br /><br /><span style="color: #0000e6;">import</span> javax.swing.JFrame;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> JavaPureMVCMinimal01Form <span style="color: #0000e6;">extends</span> FrameView {<br /><br />    <span style="color: #0000e6;"><strong>public</strong></span> <strong>javax.swing.JTextField inputFieldTxt; </strong><span style="color: #969696;"><strong>// ADD</strong></span><br /><br />    <span style="color: #0000e6;">public</span> JavaPureMVCMinimal01Form(SingleFrameApplication app) {<br />        <span style="color: #0000e6;">super</span>(app);<br /><br />        initComponents();<br />        <strong>inputFieldTxt = jTextField1; </strong><span style="color: #969696;"><strong>// ADD</strong></span><br /><br />        …<br />        …<br /><br />}</pre>
    <p style="margin-top: 0.42cm; page-break-after: avoid;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Step 3. Move the business logic into a Command class</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Let's now move the behaviour (changing text to uppercase) out of the mediator and into a proper command class.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * DataSubmittedCommand.java</span><br /><span style="color: #969696;"> */</span><br /><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.ICommand;<br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.INotification;<br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.command.SimpleCommand;<br /><br /><span style="color: #0000e6;">import</span> javapuremvcminimal01.JavaPureMVCMinimal01Form;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>DataSubmittedCommand</strong> <span style="color: #0000e6;">extends</span> SimpleCommand <span style="color: #0000e6;">implements</span> ICommand {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> execute(INotification notification)<br />    {<br />        String mydata = (String) notification.getType();<br />        JavaPureMVCMinimal01Form viewComponent = (JavaPureMVCMinimal01Form) notification.getBody();<br />        viewComponent.inputFieldTxt.setText(mydata.toUpperCase());<br />    }<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">When the execute method gets called the first thing the execute code should do is decode the notification message for juicy information. Its fairly arbitrary how you use the notification class fields .getBody() and getType(). In the java implementation the only limitation is that getBody() holds an object and getType() a string. Use your own convention on how to use these two parameters, which can be different for each unique notifcation message - just make sure your <span style="font-family: Courier New,monospace;"><span style="font-size: x-small;"><span style="font-weight: normal;">sendNotification</span></span></span> sends the right things to match how you are decoding things. </span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">In the example so far, in the notification message DATA_SUBMITTED I use the getBody() field to pass a reference to the viewcomponent, i.e. the form. This is only a temporary situation, we will later change this so that the command simply raises a message and let the mediator deal with the viewcomponent (which is the mediators job). I use the getType() parameter of the notification message to hold the text of the edit control at the time when the use hit ENTER.</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Now the mediator has changed a little. It no longer does the work of uppercase, it delegates this entirely to the command class simply by raising a <span style="font-family: Courier New,monospace;"><span style="font-size: x-small;"><span style="font-weight: normal;">DATA_SUBMITTED</span></span></span> message:</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * MyFormMediator.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.mediator.Mediator;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.INotification;<br /><span style="color: #0000e6;">import</span> javapuremvcminimal01.JavaPureMVCMinimal01Form;<br /><br /><span style="color: #0000e6;">import</span> java.awt.event.ActionEvent;<br /><span style="color: #0000e6;">import</span> java.awt.event.ActionListener;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>MyFormMediator</strong> <span style="color: #0000e6;">extends</span> Mediator <span style="color: #0000e6;">implements</span> ActionListener {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String NAME = <span style="color: #ce7b00;">"MyFormMediator"</span>;<br /><br />    <span style="color: #0000e6;">public</span> MyFormMediator(JavaPureMVCMinimal01Form viewComponent)<br />    {<br />        <span style="color: #0000e6;">super</span>(NAME, <span style="color: #0000e6;">null</span>);<br /><br />        setViewComponent(viewComponent);<br />        viewComponent.inputFieldTxt.addActionListener(<span style="color: #0000e6;">this</span>);<br />    }<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> actionPerformed(ActionEvent evt) {<br />        JavaPureMVCMinimal01Form form = (JavaPureMVCMinimal01Form) viewComponent;<br /><br />        <span style="text-decoration: line-through;">form.inputFieldTxt.setText(form.inputFieldTxt.getText().toUpperCase());</span><br />        <strong>this.sendNotification(AppFacade.DATA_SUBMITTED, viewComponent, form.inputFieldTxt.getText());</strong><br />    }<br /><br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Note that another way to send a notification message (instead of <span style="font-family: Courier New,monospace;"><span style="font-size: x-small;"><span style="font-weight: normal;">sendNotification</span></span></span>) is:</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre>        import org.puremvc.java.patterns.observer.Notification;<br /><br />        this.facade.notifyObservers(new Notification(AppFacade.DATA_SUBMITTED, <br />              viewComponent, form.inputFieldTxt.getText()));</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">however this is a bit PureMVC old school and not quite as clean as what we have used.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">We also have needed to create our own concrete Facade class so that we can define our own message types.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * AppFacade.java</span><br /><span style="color: #969696;"> */</span><br /><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.facade.Facade;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>AppFacade</strong> <span style="color: #0000e6;">extends</span> Facade {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String DATA_SUBMITTED = <span style="color: #ce7b00;">"DATA_SUBMITTED"</span>;<br /><br />    <span style="color: #0000e6;">private</span> <span style="color: #0000e6;">static</span> AppFacade instance = <span style="color: #0000e6;">null</span>;<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> AppFacade getInst()<br />    {<br />        <span style="color: #0000e6;">if</span> (instance == <span style="color: #0000e6;">null</span>) {<br />            instance = <span style="color: #0000e6;">new</span> AppFacade();<br />        }<br />        <span style="color: #0000e6;">return</span> (AppFacade) instance;<br />    }<br /><br />    @Override<br />    <span style="color: #0000e6;">protected</span> <span style="color: #0000e6;">void</span> initializeController()<br />    {<br />        <span style="color: #0000e6;">super</span>.initializeController();<br /><br />        registerCommand(DATA_SUBMITTED, DataSubmittedCommand.<span style="color: #0000e6;">class</span>);<br />    }<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">And of course we instantiate our own concrete facade instead of the base class facade:</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * JavaPureMVCMinimal01App.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #969696;"> …</span><br /><span style="color: #969696;"> …</span><br /><br />    @Override <span style="color: #0000e6;">protected</span> <span style="color: #0000e6;">void</span> startup() {<br />        myForm = <span style="color: #0000e6;">new</span> JavaPureMVCMinimal01Form(<span style="color: #0000e6;">this</span>);<br /><br />        <span style="text-decoration: line-through;"><span style="font-weight: normal;">Facade mvcfacade = Facade.getInstance();</span></span><br />        <strong>Facade mvcfacade = AppFacade.getInst();</strong><br /><br />        <span style="font-weight: normal;">mvcfacade.registerMediator(</span><span style="color: #0000e6;"><span style="font-weight: normal;">new</span></span> <span style="font-weight: normal;">MyFormMediator(myForm));</span><br />        show(myForm);<br />    <span style="font-family: Times New Roman,serif;">}</span></pre>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-top: 0.42cm;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Step 4. Move the ability to access the GUI out of the Command class</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Let's now have the command raise a notification message after it has done its work, and let the <em>mediator</em> look after putting the result back into the gui.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * MyFormMediator.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.mediator.Mediator;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.INotification;<br /><span style="color: #0000e6;">import</span> javapuremvcminimal01.JavaPureMVCMinimal01Form;<br /><br /><span style="color: #0000e6;">import</span> java.awt.event.ActionEvent;<br /><span style="color: #0000e6;">import</span> java.awt.event.ActionListener;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>MyFormMediator</strong> <span style="color: #0000e6;">extends</span> Mediator <span style="color: #0000e6;">implements</span> ActionListener {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String NAME = <span style="color: #ce7b00;">"MyFormMediator"</span>;<br /><br />    <span style="color: #0000e6;">public</span> MyFormMediator(JavaPureMVCMinimal01Form viewComponent)<br />    {<br />        <span style="color: #0000e6;">super</span>(NAME, <span style="color: #0000e6;">null</span>);<br /><br />        setViewComponent(viewComponent);<br />        viewComponent.inputFieldTxt.addActionListener(<span style="color: #0000e6;">this</span>);<br />    }<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> actionPerformed(ActionEvent evt) {<br />        JavaPureMVCMinimal01Form form = (JavaPureMVCMinimal01Form) viewComponent;<br /><br />        <span style="text-decoration: line-through;">form.inputFieldTxt.setText(form.inputFieldTxt.getText().toUpperCase());</span><br />        <strong>this.sendNotification(AppFacade.DATA_SUBMITTED, viewComponent, form.inputFieldTxt.getText());</strong><br />    }<br /><br />    <strong>@Override</strong><br />    <span style="color: #0000e6;"><strong>public</strong></span> <strong>String[] listNotificationInterests()</strong><br />    <strong>{</strong><br />        <span style="color: #0000e6;"><strong>return</strong></span> <span style="color: #0000e6;"><strong>new</strong></span> <strong>String[] {AppFacade.DATA_CHANGED};</strong><br />    <strong>}</strong><br /><br />    <strong>@Override</strong><br />    <span style="color: #0000e6;"><strong>public</strong></span> <span style="color: #0000e6;"><strong>void</strong></span> <strong>handleNotification(INotification notification)</strong><br />    <strong>{ </strong><br />        <span style="color: #0000e6;"><strong>if</strong></span><strong>(notification.getName().equals(AppFacade.DATA_CHANGED))</strong><br />        <strong>{</strong><br />            <strong>System.out.println(</strong><span style="color: #ce7b00;"><strong>"handleNotification (mediator) "</strong></span> <strong>+ notification.getType());</strong><br /><br />            <strong>String mydata = (String) notification.getType();</strong><br />            <strong>JavaPureMVCMinimal01Form form = (JavaPureMVCMinimal01Form) viewComponent;</strong><br />            <strong>form.inputFieldTxt.setText(mydata);</strong><br />        <strong>}</strong><br />    <strong>}</strong><br /><span style="font-family: Times New Roman,serif;">}</span><br /><br /><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * DataSubmittedCommand.java</span><br /><span style="color: #969696;"> */</span><br /><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.ICommand;<br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.INotification;<br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.command.SimpleCommand;<br /><br /><span style="text-decoration: line-through;"><span style="color: #0000e6;">import</span> javapuremvcminimal01.JavaPureMVCMinimal01Form;</span><br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>DataSubmittedCommand</strong> <span style="color: #0000e6;">extends</span> SimpleCommand <span style="color: #0000e6;">implements</span> ICommand {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> execute(INotification notification)<br />    {<br />        String mydata = (String) notification.getType();<br />        <span style="text-decoration: line-through;">JavaPureMVCMinimal01Form viewComponent = (JavaPureMVCMinimal01Form) notification.getBody();</span><br />        <span style="text-decoration: line-through;">viewComponent.inputFieldTxt.setText(mydata.toUpperCase());</span><br />        <strong>this.sendNotification(AppFacade.DATA_CHANGED, null, mydata.toUpperCase());</strong><br />    }<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Notice that the mediator is putting the result of the command behaviour (the uppercasing of user entered text) into the gui – the command is not touching the GUI anymore, which explains why the command no longer needs to import the GUI form class </span><span style="text-decoration: none;"><span style="font-family: Courier New,monospace;"><span style="font-size: x-small;">JavaPureMVCMinimal01Form.</span></span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">The command class </span><span style="font-family: Courier New,monospace;"><span style="font-size: x-small;"><span style="font-weight: normal;">DataSubmittedCommand</span></span></span> <span style="font-family: Times New Roman,serif;">simply raises a notification, passing the changed text as part of the notifcation message (we are using the getType() parameter to hold the uppercased string – though we could have passed it around in the getBody() parameter).</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Finally we need to add the new notification message type to the facade:</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * AppFacade.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.facade.Facade;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>AppFacade</strong> <span style="color: #0000e6;">extends</span> Facade {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String DATA_SUBMITTED = <span style="color: #ce7b00;">"DATA_SUBMITTED"</span>;<br />    <span style="color: #0000e6;"><strong>public</strong></span> <span style="color: #0000e6;"><strong>static</strong></span> <span style="color: #0000e6;"><strong>final</strong></span> <strong>String DATA_CHANGED = </strong><span style="color: #ce7b00;"><strong>"DATA_CHANGED"</strong></span><strong>;</strong><br />    …<br />    …<br />}</pre>
    <p style="margin-top: 0.42cm; page-break-after: avoid;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Step 5. Add a Model</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Let's add a proper model. For now we leave out the real model behind the proxy and use the proxy class as both proxy and model.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * DataModelProxy.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.proxy.Proxy;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>DataModelProxy</strong> <span style="color: #0000e6;">extends</span> Proxy {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String NAME = <span style="color: #ce7b00;">"DataModelProxy"</span>;<br /><br />    <span style="color: #0000e6;">private</span> String data;<br /><br />    <span style="color: #0000e6;">public</span> DataModelProxy()<br />    {<br />        <span style="color: #0000e6;">super</span>(NAME, <span style="color: #0000e6;">null</span>);<br />        <span style="color: #0000e6;">this</span>.data = <span style="color: #ce7b00;">""</span>;<br />    }<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> setData(String data) {<br />        <span style="color: #0000e6;">this</span>.data = data;<br />        System.out.println(<span style="color: #ce7b00;">"setData (model) "</span> + data);<br />        <span style="color: #0000e6;">this</span>.sendNotification(AppFacade.DATA_CHANGED, <span style="color: #0000e6;">null</span>, <span style="color: #0000e6;">this</span>.data);<br />    }<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">We alter the command class to poke the uppercase string into the model. We then let the model notify the world that the model data has altered.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * DataSubmittedCommand.java</span><br /><span style="color: #969696;"> */</span><br /><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.ICommand;<br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.INotification;<br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.command.SimpleCommand;<br /><br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>DataSubmittedCommand</strong> <span style="color: #0000e6;">extends</span> SimpleCommand <span style="color: #0000e6;">implements</span> ICommand {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> execute(INotification notification)<br />    {<br />        String mydata = (String) notification.getType();<br />        <span style="text-decoration: line-through;">this.sendNotification(AppFacade.DATA_CHANGED, null, mydata.toUpperCase());</span><br />        <strong>DataModelProxy datamodelProxy = (DataModelProxy) facade.retrieveProxy(DataModelProxy.NAME);</strong><br />        <strong>datamodelProxy.setData(mydata.toUpperCase());</strong><br />    }<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Finally we need to instantiate and register the DataModelProxy instance in the application's startup code:</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * JavaPureMVCMinimal01App.java</span><br /><span style="color: #969696;"> */</span><br /><br /><span style="color: #0000e6;">package</span> javapuremvcminimal01;<br /><br /><span style="color: #0000e6;">import</span> org.jdesktop.application.Application;<br /><span style="color: #0000e6;">import</span> org.jdesktop.application.SingleFrameApplication;<br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.facade.Facade;<br /><span style="color: #0000e6;">import</span> org.andy.MyFormMediator;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> JavaPureMVCMinimal01App <span style="color: #0000e6;">extends</span> SingleFrameApplication {<br />    <span style="color: #0000e6;">public</span> JavaPureMVCMinimal01Form myForm;<br /><br />    <span style="color: #969696;">/**</span><br /><span style="color: #969696;"> * At</span> <span style="color: #969696;">startup</span> <span style="color: #969696;">create</span> <span style="color: #969696;">and</span> <span style="color: #969696;">show</span> <span style="color: #969696;">the</span> <span style="color: #969696;">main</span> <span style="color: #969696;">frame</span> <span style="color: #969696;">of</span> <span style="color: #969696;">the</span> <span style="color: #969696;">application.</span><br />     <span style="color: #969696;">*/</span><br />    @Override <span style="color: #0000e6;">protected</span> <span style="color: #0000e6;">void</span> startup() {<br />        myForm = <span style="color: #0000e6;">new</span> JavaPureMVCMinimal01Form(<span style="color: #0000e6;">this</span>);<br />        Facade mvcfacade = AppFacade.getInst();<br />        <span style="font-weight: normal;">mvcfacade.registerMediator(</span><span style="color: #0000e6;"><span style="font-weight: normal;">new</span></span> <span style="font-weight: normal;">MyFormMediator(myForm));</span><br />        <strong>mvcfacade.registerProxy(new DataModelProxy());</strong><br />        show(myForm);<br />    }<br />    …<br />    …<br /><span style="font-family: Times New Roman,serif;">}</span></pre>
    <p style="margin-top: 0.42cm; page-break-after: avoid;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Step 6. Add a real Model behind the Model Proxy and Initialise the Model</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Let's now add a proper model that the model proxy wraps.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * Data.java</span><br /><span style="color: #969696;"> */</span><br /><strong><span style="color: #0000e6;">package </span><span style="color: #000000;">org.andy</span><span style="color: #0000e6;">;</span></strong><br /><br /><strong><span style="color: #0000e6;">public class </span><span style="color: #000000;">Data</span><span style="color: #0000e6;"> {</span></strong><br /><br /><span style="color: #0000e6;"><strong>public String </strong></span><span style="color: #000000;"><strong>data</strong></span><span style="color: #0000e6;"><strong>;</strong></span><br /><br /><span style="color: #0000e6;"><strong>public </strong></span><span style="color: #000000;"><strong>Data() {</strong></span><br /><span style="color: #0000e6;"><strong>this.</strong></span><span style="color: #000000;"><strong>data</strong></span><span style="color: #0000e6;"><strong>= </strong></span><span style="color: #ce7b00;"><strong>"Hello - hit enter";</strong></span><br /><span style="color: #000000;"><strong>}</strong></span><br /><strong>}</strong><br /><br /><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * DataModelProxy.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.proxy.Proxy;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>DataModelProxy</strong> <span style="color: #0000e6;">extends</span> Proxy {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String NAME = <span style="color: #ce7b00;">"DataModelProxy"</span>;<br /><br />    <span style="color: #0000e6;"><span style="text-decoration: line-through;">private</span></span><span style="text-decoration: line-through;"> String data;</span><br />    <span style="color: #0000e6;"><strong>private</strong></span> <strong>Data realdata;</strong><br /><br />    <span style="color: #0000e6;">public</span> DataModelProxy()<br />    {<br />        <span style="color: #0000e6;">super</span>(NAME, <span style="color: #0000e6;">null</span>);<br />        <span style="color: #0000e6;"><span style="text-decoration: line-through;">this</span></span><span style="text-decoration: line-through;">.data = </span><span style="color: #ce7b00;"><span style="text-decoration: line-through;">""</span></span><span style="text-decoration: line-through;">;</span><br />        <span style="color: #0000e6;"><strong>this</strong></span><strong>.realdata = new Data();</strong><br />        <span style="color: #0000e6;"><strong>this</strong></span><strong>.sendNotification(AppFacade.DATA_CHANGED, null, this.realdata.data);</strong><br />    }<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> setData(String data) {<br />        <span style="color: #0000e6;"><span style="text-decoration: line-through;">this</span></span><span style="text-decoration: line-through;">.data = data;</span><br />        <span style="color: #0000e6;">this</span>.realdata.data = data;<br />        System.out.println(<span style="color: #ce7b00;">"setData (model) "</span> + data);<br />        <span style="color: #0000e6;"><span style="text-decoration: line-through;">this</span></span><span style="text-decoration: line-through;">.sendNotification(AppFacade.DATA_CHANGED, </span><span style="color: #0000e6;"><span style="text-decoration: line-through;">null</span></span><span style="text-decoration: line-through;">, </span><span style="color: #0000e6;"><span style="text-decoration: line-through;">this</span></span><span style="text-decoration: line-through;">.data);</span><br />        <span style="color: #0000e6;">this</span>.sendNotification(AppFacade.DATA_CHANGED, <span style="color: #0000e6;">null</span>, <span style="color: #0000e6;">this</span>.realdata.data);<br />    }<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">I have make the model string data public to keep the example simple. Feel free to add setters and getters.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-top: 0.42cm; page-break-after: avoid;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Step 7. Move the startup code into a startup command class</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Let's now create a startup command and move as much of the startup logic into there.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * StartupCommand.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.ICommand;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.interfaces.INotification;<br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.command.SimpleCommand;<br /><br /><span style="color: #0000e6;">import</span> javapuremvcminimal01.JavaPureMVCMinimal01App;<br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> StartupCommand <span style="color: #0000e6;">extends</span> SimpleCommand <span style="color: #0000e6;">implements</span> ICommand {<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> execute(INotification notification)<br />    {<br />        System.out.println(<span style="color: #ce7b00;">"startup execute (command) "</span> + notification.getBody());<br /><br />        JavaPureMVCMinimal01App app = (JavaPureMVCMinimal01App) notification.getBody();<br />        facade.registerMediator(<span style="color: #0000e6;">new</span> MyFormMediator(app.myForm));<br />        facade.registerProxy(<span style="color: #0000e6;">new</span> DataModelProxy());<br />    }<br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">We need register the startup command with the facade and define a STARTUP message which will be used to trigger it:</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * AppFacade.java</span><br /><span style="color: #969696;"> */</span><br /><span style="color: #0000e6;">package</span> org.andy;<br /><br /><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.facade.Facade;<br /><strong><span style="color: #0000e6;">import</span> javapuremvcminimal01.JavaPureMVCMinimal01App;</strong><br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> <strong>AppFacade</strong> <span style="color: #0000e6;">extends</span> Facade {<br /><br />    <strong><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String STARTUP = <span style="color: #ce7b00;">"STARTUP"</span>;</strong><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String DATA_SUBMITTED = <span style="color: #ce7b00;">"DATA_SUBMITTED"</span>;<br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> <span style="color: #0000e6;">final</span> String DATA_CHANGED = <span style="color: #ce7b00;">"DATA_CHANGED"</span>;<br /><br />    <span style="color: #0000e6;">private</span> <span style="color: #0000e6;">static</span> AppFacade instance = <span style="color: #0000e6;">null</span>;<br /><br />    <span style="color: #0000e6;">public</span> <span style="color: #0000e6;">static</span> AppFacade getInst()<br />    {<br />        <span style="color: #0000e6;">if</span> (instance == <span style="color: #0000e6;">null</span>) {<br />            instance = <span style="color: #0000e6;">new</span> AppFacade();<br />        }<br />        <span style="color: #0000e6;">return</span> (AppFacade) instance;<br />    }<br /><br />    @Override<br />    <span style="color: #0000e6;">protected</span> <span style="color: #0000e6;">void</span> initializeController()<br />    {<br />        <span style="color: #0000e6;">super</span>.initializeController();<br /><br />        <strong>registerCommand(STARTUP, StartupCommand.<span style="color: #0000e6;">class</span>);</strong><br />        registerCommand(DATA_SUBMITTED, DataSubmittedCommand.<span style="color: #0000e6;">class</span>);<br />    }<br /><br />    <strong><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">void</span> startup(JavaPureMVCMinimal01App app)</strong><br />    <strong>{</strong><br />        <strong><span style="color: #0000e6;">this</span>.sendNotification(STARTUP, app, <span style="color: #0000e6;">null</span>);</strong><br />    <strong>}</strong><br />}</pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">And we need to alter the application startup code to do less. Notice that we lose the need for some imports, thus proving that a reason for having the startup command is to decouple and loosen dependencies.</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <pre><span style="color: #969696;">/*</span><br /><span style="color: #969696;"> * JavaPureMVCMinimal01App.java</span><br /><span style="color: #969696;"> */</span><br /><br /><span style="color: #0000e6;">package</span> javapuremvcminimal01;<br /><br /><span style="color: #0000e6;">import</span> org.jdesktop.application.Application;<br /><span style="color: #0000e6;">import</span> org.jdesktop.application.SingleFrameApplication;<br /><span style="text-decoration: line-through;"><span style="color: #0000e6;">import</span> org.puremvc.java.patterns.facade.Facade;</span><br /><strong><span style="color: #0000e6;">import</span> org.andy.AppFacade;</strong><br /><span style="text-decoration: line-through;"><span style="color: #0000e6;">import</span> org.andy.MyFormMediator;</span><br /><span style="text-decoration: line-through;"><span style="color: #0000e6;">import</span> org.andy.DataModelProxy;</span><br /><br /><span style="color: #0000e6;">public</span> <span style="color: #0000e6;">class</span> JavaPureMVCMinimal01App <span style="color: #0000e6;">extends</span> SingleFrameApplication {<br />    <span style="color: #0000e6;">public</span> JavaPureMVCMinimal01Form myForm;<br /><br />    <span style="color: #969696;">/**</span><br /><span style="color: #969696;"> * At</span> <span style="color: #969696;">startup</span> <span style="color: #969696;">create</span> <span style="color: #969696;">and</span> <span style="color: #969696;">show</span> <span style="color: #969696;">the</span> <span style="color: #969696;">main</span> <span style="color: #969696;">frame</span> <span style="color: #969696;">of</span> <span style="color: #969696;">the</span> <span style="color: #969696;">application.</span><br />     <span style="color: #969696;">*/</span><br />    @Override <span style="color: #0000e6;">protected</span> <span style="color: #0000e6;">void</span> startup() {<br />        myForm = <span style="color: #0000e6;">new</span> JavaPureMVCMinimal01Form(<span style="color: #0000e6;">this</span>);<br />        <span style="text-decoration: line-through;">Facade</span> <strong>AppFacade</strong> mvcfacade = AppFacade.getInst();<br />        <span style="text-decoration: line-through;"><span style="font-weight: normal;">mvcfacade.registerMediator(</span></span><span style="color: #0000e6;"><span style="text-decoration: line-through;"><span style="font-weight: normal;">new</span></span></span><span style="text-decoration: line-through;"><span style="font-weight: normal;">MyFormMediator(myForm));</span></span><br />        <span style="text-decoration: line-through;"><span style="font-weight: normal;">mvcfacade.registerProxy(new DataModelProxy());</span></span><br />        <strong>mvcfacade.startup(this);</strong><br />        show(myForm);<br />    }<br />    …<br />    …<br /><span style="font-family: Times New Roman,serif;">}</span></pre>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Since we are calling a brand new startup() method on our concrete facade, and this method is not declared in the Facade base class, we need to change the declaration we have been using from Facade to AppFacade. The author of PureMVC recommends this technique of bootstrapping however whether the startup() method officially makes it into the base class in future versions of PureMVC remains to be seen. We don't have to hold our breath for this, as you can see, we simply define our own startup() method on our own concrete facade class.</span></p>
    <p style="margin-top: 0.42cm; page-break-after: avoid;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Step 8. Java specific – Organise the classes into packages</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">You could potentially move the classes into packages that reflect the roles they are playing. How about:</span></p>
    <ul>
    <li>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Data and DataModelProxy → <strong>Model</strong> package</span></p>
    </li>
    <li>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">DataSubmittedCommand and StartupCommand → <strong>Controller</strong> package</span></p>
    </li>
    <li>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">MyFormMediator and JavaPureMVCMinimal01Form → <strong>View</strong> package</span></p>
    </li>
    </ul>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">and we might as well...</span></p>
    <ul>
    <li>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">JavaPureMVCMinimal01App and AppFacade → <strong>App</strong> package</span></p>
    </li>
    </ul>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Here is the final code.</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">Here are a couple of screenshots of the GUI in operation:</span></p>
    <p style="margin-bottom: 0cm;"><img src="http://www.atug.com/images/PureMvcRefactorImages/puremvcfussJAVA1.png" alt="" width="416" height="194" align="left" border="0" /></p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Courier New,monospace;">compile:</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Courier New,monospace;">run:</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Courier New,monospace;">startup execute (command) javapuremvcminimal01.JavaPureMVCMinimal01App@1e67ac</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Courier New,monospace;">handleNotification (mediator) Hello - hit enter</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">User hits ENTER</span></p>
    <p style="margin-bottom: 0cm;"><img src="http://www.atug.com/images/PureMvcRefactorImages/puremvcfussJAVA2.png" alt="" width="416" height="194" align="left" border="0" /></p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Courier New,monospace;">setData (model) HELLO - HIT ENTER</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Courier New,monospace;">handleNotification (mediator) HELLO - HIT ENTER</span></p>
    <p style="margin-bottom: 0cm;"> </p>
    <p style="margin-top: 0.42cm; page-break-after: avoid;"><span style="font-family: Albany,sans-serif;"><span style="font-size: medium;">Conclusion</span></span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">We have seen how we can introduce PureMVC into an existing Netbeans application, step by step. I haven't hooked up the about box or the menus into the PureMVC system because these things were created by default by Netbeans and I was focussed simply on duplicating the Python minimalist example. The java source code can be found <a href="http://www.atug.com/downloads/puremvcrefactor_java.zip">here</a>.</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">The Python version of this code contains much more explanation so you may want to study <a href="http://www.atug.com/downloads/puremvcrefactor_python.zip">that</a> too, as well as read the more <a title="Refactoring to PureMVC" href="http://www.andypatterns.com/index.php?cID=84">in-depth puremvc refactoring walkthrough</a> based on an idential, python example. Now to put together a C# version? ;-)</span></p>
    <p style="margin-bottom: 0cm;"><span style="font-family: Times New Roman,serif;">-Andy Bulka</span><span style="font-family: Times New Roman,serif;"><br />March 2009</span></p>

</body>

</html>